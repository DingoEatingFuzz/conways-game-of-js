<!doctype html>
<html>
<head>
    <meta charset='utf-8'/>
    <script src='jlife.js'></script>
    <div id='game-box'>
        <canvas id='game'      width='1200px' height='800px'></canvas>
        <canvas id='game-grid' width='1200px' height='800px'></canvas>
    </div>
    <style>
        #game-box { position:relative; margin:auto; }
        #game, #game-grid { position:absolute; top:0; left:0; }
        #game, #game-grid, #game-box { width:1200px; height:800px;}
    </style>
</head>
<body>
    <script>
        var board1 = JLife(5, 5, [
            0, 0, 0, 0, 0,
            0, 0, 0, 0, 0,
            0, 1, 1, 1, 0,
            0, 0, 0, 0, 0,
            0, 0, 0, 0, 0
        ]);

        var board2 = JLife(17, 17, [
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,
            0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,
            0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
        ]);

        var board3 = JLife(300, 200);

        var canvas = document.getElementById('game');
        var ctx    = canvas.getContext('2d');

        initGrid(4);

        var loop = setInterval(function() {
            board3.step();
            canvasBigPrintBoard(board3, ctx, 4);
        }, 1000/25);

        function canvasPrintBoard(board, ctx) {
            imageData = ctx.createImageData(board.width, board.height);
            for (var i = 0, len = board.cells.length; i < len; ++i) {
                var idx = i * 4;
                var color = board.cells[i] ? 0 : 255;
                imageData.data[idx]   = imageData.data[idx+1] = imageData.data[idx+2] = color;
                imageData.data[idx+3] = 255;
            }
            ctx.putImageData(imageData, 0, 0);
        }

        function canvasBigPrintBoard(board, ctx, size) {
            ctx.fillStyle = '#FFF';
            ctx.fillRect(0, 0, board.width * size, board.height * size);
            ctx.fillStyle = '#09F';
            for (var i = 0, len = board.cells.length; i < len; ++i) {
                var x = i % board.width, y = Math.floor(i / board.width);
                if (board.cells[i]) ctx.fillRect(x * size, y * size, size, size);
            }
        }

        function printBoard(board) {
            console.log(
                board.cells.toString()
                    .replace(/,/g, '')
                    .replace(/(\d{50})/g, '$1\n')
                    .replace(/0/g, ' ')
                    .replace(/1/g, 'X')
            );
        }

        function initGrid(size) {
            var canvas = document.getElementById('game-grid'),
                ctx    = canvas.getContext('2d');
            ctx.strokeStyle = '#CCC';
            ctx.lineWidth   = 1;
            for (var i = 0, len = canvas.width; i <= len; i += size) {
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
            }
            for (i = 0, len = canvas.height; i <= len; i += size) {
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
            }
            ctx.stroke();
            ctx.closePath();
        }

        function kill() {
            clearInterval(loop);
        }
    </script>
</body>
</html>